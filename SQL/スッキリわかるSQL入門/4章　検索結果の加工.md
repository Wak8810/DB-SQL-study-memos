- SELECT文onlyの装飾
- whereで絞ってからさらに加工するイメージ
## DISTINCT
- 重複行削除
	- 費目のみ確認とか
- SELECT直後
## ORDER BY
- 指定した値を基準に並べ替え
- ORDER BY 列 並び順
	- 複数指定可能
	- 列 並び順をカンマでつなぐ
	- 列を列番号にしてもいいけど、あんま使わない
- 存在しない場合、順序が保障されないので注意
## OFFSET-FETCH
- 並べ替えた結果の一部を取得する
- ORDER BYの後につなげる(SQL Server以外？)
	- 使えないのもあり、Postgreは使えないらしい
	- oracleとか使えるね
```sql
SELECT * FROM table
ORDER BY column
OFFSET 除外する行数 ROWS
FETCH NEXT 取得行数 ROWS ONLY
```
- DBMSによっては、OFFSETも省略可能。
- FETCH省略したら、該当行全て
- 10,5で指定したら、11~15行ゲト
- FETCHと似た概念の物は他のDBMSにもある
	- LIMIT
	- ROW_NUMBER(使い方特殊)
	- ROWNUM(使い方特殊)
	- TOP
## 集合演算子
- アーカイブテーブルと、最近のデータのみのテーブルがある時
- UNION、EXCEPT(MINUS)、INTERSECT
	- 和集合、差集合、積集合
## UNION
- SELECTとSELECTをUNIONでつなぐと、和が返される
	- もちろんwhereとかも可能
	- 和集合なので、このままだと完全重複は一つで出力されるので注意！
		- UNION ALLで全部に
```sql
SELECT column FROM table
UNION (ALL)
SELECT column FROM table
```
- 選択した列の列数とデータ型が一致していないと使えない
	- 逆に、異なるテーブルでも一致していれば抽出できる
- 一つのテーブルでも使える。
	- 異なるwehre条件のselectをunionして、一つの文でいろいろできる
- ORDER BYを使う際の注意
	- 最後のSELECT文に記述する
	- 列番号以外による指定の時、１つめのSELECT文に記述したものを指定する。
		- おそらく、別の型でも、一つ目の名前で統一されそう
## EXCEPT-MINUS
- selectで出た行から、別のselect文にある行を差し引いたやつ
```sql
SELECT 文
EXCEPT (ALL)
SELECT 文
```
- OracleではMINUS
- ALLを付けたら、全部返す
- EXCEPT前のやつが基準で、その後を引く
- その他はUNIONと同じ
## INTERSECT
- 積集合
- 共通行なのでALLはない
- その他は他と同じ

## 注意
- ORDERBY,DISTINCT,UNIONは重い処理

```sql
SELECT * FROM 注文履歴
ORDER BY 注文順,明細順

SELECT 商品名 FROM 注文履歴
WHERE 日付 >= '2022-01-01' AND 日付 <= '2022-01-31'
ORDER BY 商品名

SELECT 注文番号,注文枝番,注文金額 FROM 注文履歴
WHERE 分類='2'
ORDER BY 注文金額
OFFSET 1 ROWS
FETCH NEXT 3 ROWS ONLY

SELECT 日付,商品名,単価,数量,注文金額 FROM 注文履歴
WHERE 数量 >= 2 AND 分類 = '3'

```



